<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>互补滤波器小项目 | Your awesome title</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="互补滤波器小项目" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="MahonyAHRS算法的实现" />
<meta property="og:description" content="MahonyAHRS算法的实现" />
<link rel="canonical" href="http://localhost:4000/2016/11/20/%E4%BA%92%E8%A1%A5%E6%BB%A4%E6%B3%A2%E5%99%A8%E7%9A%84%E5%B0%8F%E9%A1%B9%E7%9B%AE.html" />
<meta property="og:url" content="http://localhost:4000/2016/11/20/%E4%BA%92%E8%A1%A5%E6%BB%A4%E6%B3%A2%E5%99%A8%E7%9A%84%E5%B0%8F%E9%A1%B9%E7%9B%AE.html" />
<meta property="og:site_name" content="Your awesome title" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-11-20T00:00:00+08:00" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2016/11/20/%E4%BA%92%E8%A1%A5%E6%BB%A4%E6%B3%A2%E5%99%A8%E7%9A%84%E5%B0%8F%E9%A1%B9%E7%9B%AE.html"},"description":"MahonyAHRS算法的实现","headline":"互补滤波器小项目","dateModified":"2016-11-20T00:00:00+08:00","datePublished":"2016-11-20T00:00:00+08:00","@type":"BlogPosting","url":"http://localhost:4000/2016/11/20/%E4%BA%92%E8%A1%A5%E6%BB%A4%E6%B3%A2%E5%99%A8%E7%9A%84%E5%B0%8F%E9%A1%B9%E7%9B%AE.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Your awesome title" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Your awesome title</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">互补滤波器小项目</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2016-11-20T00:00:00+08:00" itemprop="datePublished">Nov 20, 2016
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h4 id="mahonyahrs算法的实现">MahonyAHRS算法的实现</h4>

<h5 id="目标">目标</h5>

<ul>
  <li>观察程序中处理时间的方法</li>
  <li>训练写C++的能力</li>
</ul>

<h5 id="eigen">eigen</h5>

<pre><code class="language-C++">Eigen::Quaterniond q1 = Eigen::Quaterniond (0.1,0.2,0.1,0.3).normalized();  //定义一个四元数并用normalized（）归一化
</code></pre>

<h5 id="出现的问题">出现的问题</h5>

<p><span style="color:green;"><strong>开发的过程中，流程没有掌握好，对函数的熟悉程度也很低。所以造成了无法定位误差的结果。利用matlab的矩阵方法求解，明显效率是更高的。</strong></span></p>

<p><span style="color:green;"><strong>最后出现NAN的错误，找不到问题在哪里，决定看一下作者本来的程序</strong></span>。</p>

<h5 id="vscode的配置">vscode的配置</h5>

<ul>
  <li>
    <p>https://blog.csdn.net/weixin_43374723/article/details/84064644</p>
  </li>
  <li>
    <p>vscode<a href="https://zhuanlan.zhihu.com/p/93239107">远程开发</a>；</p>
  </li>
</ul>

<h4 id="eskf程序的熟悉">ESKF程序的熟悉</h4>

<p>程序设计中的一些做法。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">constexpr</span> <span class="n">相当于const</span>
</code></pre></div></div>

<p>在下面的定义中，可以有效的防止重复定义的问题，就方便了很多。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#pragma once
#include &lt;Eigen/Core&gt;
#include &lt;Eigen/Dense&gt;
</span>
<span class="n">namespace</span> <span class="n">OriEst</span><span class="p">{</span>
    
  <span class="n">constexpr</span>  <span class="n">double</span> <span class="n">kDeg2Rad</span> <span class="o">=</span> <span class="n">M_PI</span> <span class="o">/</span> <span class="mf">180.</span><span class="p">;</span>
<span class="n">constexpr</span> <span class="n">double</span> <span class="n">kRad2Deg</span> <span class="o">=</span> <span class="mf">180.</span> <span class="o">/</span> <span class="n">M_PI</span><span class="p">;</span>
<span class="n">constexpr</span> <span class="n">double</span> <span class="n">kGravity</span> <span class="o">=</span> <span class="mf">9.8</span><span class="p">;</span>
<span class="n">inline</span> <span class="n">Eigen</span><span class="p">::</span><span class="n">Matrix3d</span> <span class="n">SkewMat</span><span class="p">(</span><span class="n">const</span> <span class="n">Eigen</span><span class="p">::</span><span class="n">Vector3d</span><span class="o">&amp;</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Eigen</span><span class="p">::</span><span class="n">Matrix3d</span> <span class="n">w</span><span class="p">;</span>
    <span class="n">w</span> <span class="o">&lt;&lt;</span>  <span class="mf">0.</span><span class="p">,</span>   <span class="o">-</span><span class="n">v</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>  <span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
          <span class="n">v</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>  <span class="mf">0.</span><span class="p">,</span>   <span class="o">-</span><span class="n">v</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
         <span class="o">-</span><span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>  <span class="n">v</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>  <span class="mf">0.</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">w</span><span class="p">;</span>
<span class="p">};</span>
<span class="p">}</span>
</code></pre></div></div>

<p>应对如此报错：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div>

<h5 id="智能指针的常用方法">智能指针的常用方法</h5>

<p>智能指针的用法：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">//</span><span class="n">这个具体是啥意思</span><span class="err">？</span>
<span class="n">std</span><span class="p">::</span><span class="n">make_unique</span>
</code></pre></div></div>

<ul>
  <li>
    <p>\1.  make_unique 同 unique_ptr 、auto_ptr 等一样，都是 smart pointer，可以取代new 并且无需 delete pointer，有助于代码管理。</p>
  </li>
  <li>
    <p>\2. make_unique 创建并返回 unique_ptr 至指定类型的对象，这一点从其构造函数能看出来。make_unique相较于unique_ptr 则更加安全。</p>
  </li>
  <li>
    <p>\3. 编译器不同，make_unique 要求更新（Visual Studio 2015）。</p>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#include &lt;memory&gt;
</span><span class="n">std</span><span class="p">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">Initializer</span><span class="o">&gt;</span> <span class="n">initializer_</span><span class="p">;</span>
</code></pre></div></div>

<h5 id="queue-队列对于数据的保存">queue 队列对于数据的保存</h5>

<p>在初始化的过程中，需要对加速度计的信号进行运算。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">std</span><span class="p">::</span><span class="n">deque</span><span class="o">&lt;</span><span class="n">Eigen</span><span class="p">::</span><span class="n">Vector3d</span> <span class="p">,</span> <span class="n">Eigen</span><span class="p">::</span><span class="n">aligned_allocator</span><span class="o">&lt;</span><span class="n">Eigen</span><span class="p">::</span><span class="n">Vector3d</span><span class="o">&gt;&gt;</span> <span class="n">acc_buffer_</span><span class="p">;</span>
</code></pre></div></div>

<h5 id="构造函数">构造函数</h5>

<p>构造函数等于<a href="https://blog.csdn.net/weixin_38339025/article/details/89161324">default</a>？</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Initializer</span><span class="p">()</span> <span class="o">=</span> <span class="n">default</span><span class="p">;</span>
</code></pre></div></div>

<h5 id="头文件中的定义">头文件中的定义</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#pragme once
</span></code></pre></div></div>

<p>aligned_allocator:内存分配器</p>

<h5 id="配置文件写入到类中">配置文件写入到类中</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">struct</span> <span class="n">Config</span> <span class="p">{</span>
        <span class="n">size_t</span> <span class="n">acc_buffer_size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
        <span class="n">double</span> <span class="n">max_acc_std</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
    <span class="p">};</span>
  <span class="n">const</span> <span class="n">Config</span> <span class="n">config_</span><span class="p">;</span>
</code></pre></div></div>

<h5 id="报错分析">报错分析</h5>

<p>: error: multiple types in one declaration };</p>

<p>出现了段错误：结果发现是在类中调用智能指针的时候，没有在构造函数中进行初始化导致的问题。</p>

<p>which is of non-class type</p>

<p>主函数声明类的时候多加了一个括号：（如果构造函数不需要参数，写成下面的就行了）</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">OriEst</span><span class="p">::</span><span class="n">MahonyAHRSupdate</span> <span class="n">mahonyAHRS</span>
</code></pre></div></div>

<h4 id="imu与gps信息融合c项目的实现">IMU与GPS信息融合C++项目的实现</h4>

<p>ENU笛卡尔坐标系：将GPS的WGS84坐标（大地坐标系）转换为平面坐标（笛卡尔坐标系）<a href="http://www.tansoo.cn/?p=896">的方法</a>。那么所谓的笛卡尔坐标系就是我们通常认为的参考坐标系。</p>


  </div><a class="u-url" href="/2016/11/20/%E4%BA%92%E8%A1%A5%E6%BB%A4%E6%B3%A2%E5%99%A8%E7%9A%84%E5%B0%8F%E9%A1%B9%E7%9B%AE.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Your awesome title</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Your awesome title</li><li><a class="u-email" href="mailto:your-email@example.com">your-email@example.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/jekyll"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">jekyll</span></a></li><li><a href="https://www.twitter.com/jekyllrb"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">jekyllrb</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
